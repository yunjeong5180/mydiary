<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>나의 일기장 - 홈</title>
    <link rel="stylesheet" href="/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
</head>
<body>

<!-- ─── 네비게이션 바 ───────────────────────────── -->
<nav class="nav-bar">
    <h1 class="nav-title">📘 나의 일기장</h1>
    <button id="logoutBtn" style="margin-left:auto; display:none;">Logout</button>
</nav>

<!-- ─── 메인 영역 ──────────────────────────────── -->
<main class="home-center">
    <h2>오늘의 일기를 기록해보세요 😊</h2>
    <button id="writeBtn">✍️ 새 일기 작성</button>
    <button id="listBtn">📋 일기 목록 보기</button>
</main>

<!-- ✅ 로그인 안내 모달 -->
<div id="modal-backdrop" style="display:none;">
    <div id="modal-box" style="display:none;">
        <p>로그인이 필요합니다 😅</p>
        <button id="modal-ok">로그인하러 가기</button>
    </div>
</div>

<script>
    // ✅ 로그인 상태일 때만 로그아웃 버튼 보이기
    fetch("/users/me", { credentials: "include" })
      .then(res => {
        if (res.ok) {
          document.getElementById("logoutBtn").style.display = "inline-block";
        }
      });

    // ✅ 로그아웃 처리
    document.getElementById("logoutBtn").onclick = async () => {
      await fetch('/users/logout', { method: 'POST', credentials: 'include' });
      location.href = '/login.html';
    };

    // ✅ 로그인 체크 후 이동 (모달 표시)
    function checkAndMove(path) {
      fetch("/users/me", { credentials: "include" })
        .then(res => {
          if (res.ok) {
            location.href = path;
          } else {
            document.getElementById("modal-backdrop").style.display = "block";
            document.getElementById("modal-box").style.display = "block";  // ✅ 이 부분 추가!
          }
        });
    }

    document.getElementById("writeBtn").onclick = () => checkAndMove("/write.html");
    document.getElementById("listBtn").onclick  = () => checkAndMove("/list.html");

    // ✅ 모달 내 "확인" 버튼 → 로그인 페이지 이동
    document.getElementById("modal-ok").onclick = () => {
      location.href = "/login.html";
    };
</script>

</body>
</html>
